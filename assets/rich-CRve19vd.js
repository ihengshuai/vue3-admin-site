var W=Object.defineProperty,X=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var j=(a,n,t)=>n in a?W(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,I=(a,n)=>{for(var t in n||(n={}))_.call(n,t)&&j(a,t,n[t]);if(L)for(var t of L(n))H.call(n,t)&&j(a,t,n[t]);return a},M=(a,n)=>X(a,U(n));var E=(a,n,t)=>new Promise((T,g)=>{var w=r=>{try{m(t.next(r))}catch(d){g(d)}},C=r=>{try{m(t.throw(r))}catch(d){g(d)}},m=r=>r.done?T(r.value):Promise.resolve(r.value).then(w,C);m((t=t.apply(a,n)).next())});import{b as B}from"./index-Cwyg722P.js";import{I as ee}from"./index-Ciw2v_La.js";import{I as ae}from"./index-N7FLGHHZ.js";import{s as Q,a as te,E as p,C as b,g as A,R as oe}from"./index.CCNGGU.js";import{u as le}from"./useTablePage-dZzMJE_P.js";import{u as ne}from"./useRequest-ZhiQn8-S.js";import{_ as N,Q as y,Y as re,z as V,K as h,N as se,O as R,$ as ie,J as ue,I as u}from"./antd-B5dqVz-4.js";import{d as me,Z as de,r as J,P as ce,c as K,f as pe,k as o,S as be,F as fe,E as f,i as ge}from"./vue-C05a2vRq.js";import"./index-CKfTYYqA.js";import"./dom-B5d93tGn.js";var k=(a=>(a[a.football=1]="football",a[a.basketball=2]="basketball",a[a.pingpong=3]="pingpong",a[a.running=4]="running",a[a.swimming=5]="swimming",a[a.tennis=6]="tennis",a))(k||{});Q(k,{football:{alias:"hobbies.football"},basketball:{alias:"hobbies.basketball"},pingpong:{alias:"hobbies.pingpong"},running:{alias:"hobbies.running"},swimming:{alias:"hobbies.swimming"},tennis:{alias:"hobbies.tennis"}});var P=(a=>(a.male="male",a.remale="remale",a))(P||{});Q(P,{male:{alias:"common.male"},remale:{alias:"common.remale"}});function ye(a){return N(a)}function q(a,n="YYYY-MM-DD HH:mm"){return a?N(a).format(n):null}function z(a){return N(a).isValid()}function O(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!ge(a)}const Ae=me({name:"RichTablePage",setup(){const{t:a}=te(),n=de(),t=J({defaultTool:!0,operationCollapse:0,isMockError:0});ce(()=>console.log("active..."));const{loading:T,loadingTip:g,refresh:w}=ne(G,{manual:!0,retry:5,noticeError:!0}),C=K(()=>{const e=p.getEntries(P).map(({value:c,alias:i})=>({label:a(i),value:c})),{alias:l,value:s}=p.getEntry(b.ALL,b);return e.unshift({label:a(l),value:String(s)}),e}),m=K(()=>{const e=p.getEntries(k).map(({value:c,alias:i})=>({label:a(i),value:c})),{alias:l,value:s}=p.getEntry(b.ALL,b);return e.unshift({label:a(l),value:s}),e}),r=J({keywords:{value:null,defaultValue:"",validate:e=>isNaN(parseInt(e))},sex:{value:null,defaultValue:"male",immediate:!0,validate:e=>["male","remale","-1"].includes(e),transform:e=>e==="-1"?null:e},hobbies:{value:null,defaultValue:[b.ALL],transform:e=>e==null?void 0:e.join(","),parse:e=>e==null?void 0:e.split(",").map(Number)},birthRange:{value:null,immediate:!0,validate:e=>{const[l,s]=e.split(",");return z(l)&&z(s)&&new Date(l)<new Date(s)},transform:e=>{var l;return(l=e==null?void 0:e.map)==null?void 0:l.call(e,s=>q(s,"YYYY/MM/DD")).join(",")},parse:e=>{var l;return(l=e==null?void 0:e.split(","))==null?void 0:l.map(s=>ye(s))}}}),d=pe([{title:"ID",dataIndex:"id",sorter:!0,key:"id"},{title:a("common.name"),dataIndex:"name",key:"name"},{title:a("common.age"),dataIndex:"age",sorter:!0,key:"age"},{title:a("common.sex"),dataIndex:"sex",key:"sex",customRender:({text:e})=>a(e==="male"?"common.male":"common.remale")},{title:a("common.hobbies"),dataIndex:"hobbies",key:"hobbies",ellipsis:!0,customRender:({text:e})=>e==null?void 0:e.map(l=>{var s;return a((s=p.getEntry(l,k))==null?void 0:s.alias)}).join(",")},{title:a("common.birthday"),key:"createTime",customRender:({record:e})=>q(e.createTime,"YYYY/MM/DD")},{title:a("common.operation"),key:"operation",fixed:"right",align:"center",width:160}]),Y=[{key:A.CREATE,value:a("create"),validator:e=>e.record.age!==10,disabled:e=>e.record.age>10,handler:e=>y.info("创建"+JSON.stringify(e))},{key:A.UPDATE,value:a("edit"),disabled:e=>e.record.age===16,handler:e=>{n.push({name:oe.tableDetail,params:{id:e.record.id}})}},{key:A.DELETE,value:e=>e.record.name==="关羽"?o(re,null,null):a("delete"),disabled:e=>e.record.age===16,buttonProps:{danger:!0,type:"link"},handler:e=>y.info("删除: "+e.record.id)}],{isEmpty:v,isFetchEnd:x,selection:F,tableProps:S,getFilterValue:Z,onSearch:D,resetSearch:$}=le({selectable:!0,columns:d.value,filters:r,pagination:e=>M(I({},e),{showQuickJumper:!0,showSizeChanger:!0}),fetchData:e=>E(this,null,function*(){const l=yield w(e);return t.isMockError=0,l==null?void 0:l.value[0]})});function G(e){return E(this,null,function*(){return yield B(M(I({},e),{testCode:!!t.isMockError||null}),{captureError:!1})})}return()=>{let e,l;const s=o(ue,{class:"table-form"},{default:()=>[o(V,{wrap:!0,style:"padding: 16px 0"},{default:()=>[o(h,{name:"keywords"},{default:()=>[o(se,{value:r.keywords.value,"onUpdate:value":i=>r.keywords.value=i,placeholder:a("common.keywords"),allowClear:!0,style:"width: 200px",onPressEnter:D},null)]}),o(h,{name:"sex"},{default:()=>[o(R,{value:r.sex.value,"onUpdate:value":i=>r.sex.value=i,options:C.value,style:"width: 100px"},null)]}),o(h,{name:"hobbies"},{default:()=>[o(R,{value:r.hobbies.value,"onUpdate:value":i=>r.hobbies.value=i,mode:"multiple",maxTagCount:2,placeholder:a("common.hobby-place"),options:m.value,style:"width: 220px"},null)]}),o(h,{name:"createTime",label:a("common.birthday")},{default:()=>[o(ie,{value:r.birthRange.value,"onUpdate:value":i=>r.birthRange.value=i},null)]}),o("strong",null,[(v==null?void 0:v.value)&&"没数据"]),o("strong",null,[(x==null?void 0:x.value)&&"加载完毕"])]})]}),c=o(V,null,{default:()=>[o(u,{type:"text",onClick:$},O(e=a("reset"))?e:{default:()=>[e]}),o(u,{type:"primary",onClick:D},O(l=a("search"))?l:{default:()=>[l]})]});return o(ee,{bodyStyle:{paddingTop:"2px"},title:s,extra:c},{default:()=>[o(ae,be(S.value,{title:"综合功能表",titleTip:"当前表格综合展示各种表格功能(不是全部哈.)",showTitle:!0,loading:T.value,loadingTip:g.value,operations:Y,operateCollapseMin:t.operationCollapse,defaultTool:t.defaultTool}),{toolbar:()=>o(fe,null,[o(u,{type:"link",onClick:()=>(t.isMockError=1)&&D()},{default:()=>[f("模拟错误")]}),o(u,{type:"primary",onClick:()=>y.info(JSON.stringify(Z()))},{default:()=>[f("打印表单")]}),o(u,{type:"primary",disabled:!F.selectedRowKeys.length,onClick:()=>y.info("删除"+F.selectedRowKeys.join(","))},{default:()=>[f("批量删除")]}),o(u,{onClick:()=>t.operationCollapse===1?t.operationCollapse=0:t.operationCollapse=1},{default:()=>[f("操作收缩")]}),o(u,{type:"primary",onClick:()=>t.defaultTool=!t.defaultTool},{default:()=>[f("默认工具")]})])})]})}}});export{Ae as default};
